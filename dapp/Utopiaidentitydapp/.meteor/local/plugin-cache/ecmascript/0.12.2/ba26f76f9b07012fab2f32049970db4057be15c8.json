{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$4","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$5","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$6","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$7","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$9","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/innotical/Utopia/dapp/Utopiaidentitydapp/imports/ui/pages/main/result.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"caller":{"name":"meteor","arch":"web.browser"},"sourceFileName":"imports/ui/pages/main/result.js","filename":"/home/innotical/Utopia/dapp/Utopiaidentitydapp/imports/ui/pages/main/result.js","passPerPreset":false,"envName":"development","cwd":"/home/innotical/Utopia/dapp/Utopiaidentitydapp","root":"/home/innotical/Utopia/dapp/Utopiaidentitydapp","generatorOpts":{"filename":"/home/innotical/Utopia/dapp/Utopiaidentitydapp/imports/ui/pages/main/result.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/pages/main/result.js"}},"code":"module.link(\"./result.html\");\nmodule.link(\"../../stylesheets/result.css\");\nmodule.link(\"./footer.js\");\nlet ScatterJS;\nmodule.link(\"scatterjs-core\", {\n  default(v) {\n    ScatterJS = v;\n  }\n\n}, 0);\nlet ScatterEOS;\nmodule.link(\"scatterjs-plugin-eosjs\", {\n  default(v) {\n    ScatterEOS = v;\n  }\n\n}, 1);\nlet Eos;\nmodule.link(\"eosjs\", {\n  default(v) {\n    Eos = v;\n  }\n\n}, 2);\nconst network = {\n  protocol: \"https\",\n  // Defaults to https\n  blockchain: \"eos\",\n  host: \"jungle2.cryptolions.io\",\n  port: 443,\n  chainId: \"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473\"\n};\nconst eosOptions = {\n  chainId: \"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473\"\n};\nvar scatter = {};\nvar eosinstance = {};\nTemplate.App_result.onCreated(function () {\n  Meteor.subscribe('identity');\n  ScatterJS.scatter.connect('utopia').then(connected => {\n    if (connected) {\n      if (ScatterJS.scatter.connect('utopia')) {\n        scatter = ScatterJS.scatter;\n        const requiredFields = {\n          accounts: [network]\n        };\n        const eos = scatter.eos(network, Eos, eosOptions);\n\n        if (scatter.identity) {\n          eosinstance = eos;\n          var result = [];\n          var length = 0;\n          let resultdata;\n          let candidatedata;\n          var id = FlowRouter.current().params.id;\n          console.log(\"id: \", id);\n          eosinstance.getTableRows({\n            code: \"voteproposal\",\n            scope: \"voteproposal\",\n            table: \"votes13\",\n            limit: \"50\",\n            json: true\n            /* key_type: \"i64\",\n            index_position: 2 */\n\n          }).then(response => {\n            resultdata = response; //getting the length of list of all choices for a  particular proposal\n\n            var length = 0;\n\n            for (var i = 0; i < resultdata.rows.length; i++) {\n              if (id == resultdata.rows[i].proposal_id) {\n                length = resultdata.rows[i].choices.length;\n                break;\n              }\n            } //creating a 2d array to store who got how many votes based on rank \n\n\n            for (var i = 0; i < length; i++) {\n              result[i] = [];\n            }\n\n            for (var i = 0; i < length; i++) {\n              for (var j = 0; j < length; j++) {\n                result[i][j] = 0;\n              }\n            }\n\n            var input = []; //creating a 2d array of total votes received \n\n            for (var i = 0; i < resultdata.rows.length; i++) {\n              if (id == resultdata.rows[i].proposal_id) {\n                input.push(resultdata.rows[i].choices);\n              }\n            } // calculaing votes based on ranks\n            //j is the candidate and val-1 is the total votes received for the rank\n\n\n            for (var i = 0; i < input.length; i++) {\n              for (j = 0; j < input[i].length; j++) {\n                var val = input[i][j];\n                result[j][val - 1] += 1;\n              }\n            }\n          });\n          eosinstance.getTableRows({\n            code: \"voteproposal\",\n            scope: \"voteproposal\",\n            table: \"proposal11\",\n            limit: \"50\",\n            json: true\n          }).then(response => {\n            candidatedata = response;\n          });\n          console.log(\"resultdata \", resultdata);\n          var candidatelist = [];\n\n          for (var i = 0; i < candidatedata.rows.length; i++) {\n            if (id == candidatedata.rows[i].id) {\n              for (var j = 0; j < candidatedata.rows[i].proposal_options.length; j++) {\n                var val = candidatedata.rows[i].proposal_options[j];\n                document.getElementById(\"proposal-result-name\").innerHTML += \"<br><div class = 'ep'>\" + val + \"</div>\";\n              }\n            }\n          }\n\n          console.log(\"candidatedata\", candidatedata);\n          console.log(\"result after calculating \", result);\n          /* for(var i=0;i<result.length;i++){\n              document.getElementById(\"proposal-result-votes\").innerHTML +=\"<br><div class = 'ep'>\"+ result[i].toString().replace(/,/g, '/')+\"</div>\";\n              \n          } */\n\n          for (var i = 0; i < result.length; i++) {\n            document.getElementById(\"proposal-result-votes\").innerHTML += \"<br><div class = 'ep2'></div>\";\n\n            for (var j = 0; j < result[i].length; j++) {\n              var val = result[i][j];\n              document.getElementsByClassName(\"ep2\")[i].innerHTML += \"<div class = 'vote-stat'>\" + val + \"</div>\";\n            }\n          }\n        } else {\n          FlowRouter.go(\"/\");\n        }\n      }\n    } else {\n      console.log(\"scatter not installed\");\n    }\n  });\n});\nTemplate.App_result.helpers({\n  /* calcvote: async function () {\n      var result = [];\n      var length = 0;\n      var id = FlowRouter.current().params.id;\n      console.log(\"id: \", id);\n      let resultdata = eos.getTableRows({\n          code: \"voteproposal\",\n          scope: \"voteproposal\",\n          table: \"votes13\",\n          limit: \"50\",\n          json: true,\n          key_type: \"i64\",\n          index_position: 2\n      });\n       let candidatedata = eos.getTableRows({\n          code: \"voteproposal\",\n          scope: \"voteproposal\",\n          table: \"proposal11\",\n          limit: \"50\",\n          json: true,\n      });\n      console.log(\"resultdata \", resultdata);\n      console.log(\"candidate data: \", candidatedata);\n       //getting the length of list of all choices for a  particular proposal\n      var length = 0;\n      for (var i = 0; i < resultdata.rows.length; i++) {\n          if (id == resultdata.rows[i].proposal_id) {\n              length = resultdata.rows[i].choices.length;\n              break;\n          }\n      }\n       //creating a 2d array and setting initial votes to 0\n      for (var i = 0; i < length; i++) {\n          result[i] = [];\n      }\n       for (var i = 0; i < length; i++) {\n          for (var j = 0; j < length; j++) {\n              result[i][j] = 0;\n          }\n      }\n       var input = [];\n      //creating a 2d array of total votes received \n      for (var i = 0; i < resultdata.rows.length; i++) {\n          if (id == resultdata.rows[i].proposal_id) {\n              input.push(resultdata.rows[i].choices)\n          }\n      }\n      for(var i=0;i<input.length;i++){\n          for(j=0;j<input[i].length;j++){\n              var val = input[i][j];\n              result[j][val-1] += 1;\n          }\n      }\n  \n      console.log(\"result after calculating \", result);\n      return result[0];\n   }, */\n});\nTemplate.App_result.onRendered(async function () {});","map":{"version":3,"sources":["imports/ui/pages/main/result.js"],"names":["module","link","ScatterJS","default","v","ScatterEOS","Eos","network","protocol","blockchain","host","port","chainId","eosOptions","scatter","eosinstance","Template","App_result","onCreated","Meteor","subscribe","connect","then","connected","requiredFields","accounts","eos","identity","result","length","resultdata","candidatedata","id","FlowRouter","current","params","console","log","getTableRows","code","scope","table","limit","json","response","i","rows","proposal_id","choices","j","input","push","val","candidatelist","proposal_options","document","getElementById","innerHTML","getElementsByClassName","go","helpers","onRendered"],"mappings":"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","sourcesContent":["import \"./result.html\";\nimport \"../../stylesheets/result.css\";\nimport \"./footer.js\";\nimport ScatterJS from \"scatterjs-core\";\nimport ScatterEOS from \"scatterjs-plugin-eosjs\";\nimport Eos from \"eosjs\";\nconst network = {\n  protocol: \"https\", // Defaults to https\n  blockchain: \"eos\",\n  host: \"jungle2.cryptolions.io\",\n  port: 443,\n  chainId: \"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473\"\n};\nconst eosOptions = {\n  chainId: \"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473\"\n};\n\nvar scatter={};\nvar eosinstance = {};\nTemplate.App_result.onCreated(function () {\n\n  Meteor.subscribe('identity');\n  ScatterJS.scatter.connect('utopia').then((connected) => {\n      if (connected) {\n          if (ScatterJS.scatter.connect('utopia')) {\n              scatter = ScatterJS.scatter;\n              const requiredFields = { accounts: [network] };\n              const eos = scatter.eos(network, Eos, eosOptions);\n              if (scatter.identity) {\n                  eosinstance = eos;\n                  var result = [];\n                  var length = 0;\n                  let resultdata;\n                  let candidatedata;\n                  var id = FlowRouter.current().params.id;\n                  console.log(\"id: \", id);\n                   eosinstance.getTableRows({\n                      code: \"voteproposal\",\n                      scope: \"voteproposal\",\n                      table: \"votes13\",\n                      limit: \"50\",\n                      json: true,\n                      /* key_type: \"i64\",\n                      index_position: 2 */\n                  }).then((response)=>{\n                      resultdata=response;\n                        //getting the length of list of all choices for a  particular proposal\n                  var length = 0;\n                  for (var i = 0; i < resultdata.rows.length; i++) {\n                      if (id == resultdata.rows[i].proposal_id) {\n                          length = resultdata.rows[i].choices.length;\n                          break;\n                      }\n                  }\n              \n                  //creating a 2d array to store who got how many votes based on rank \n                  for (var i = 0; i < length; i++) {\n                      result[i] = [];\n                  }\n              \n                  for (var i = 0; i < length; i++) {\n                      for (var j = 0; j < length; j++) {\n                          result[i][j] = 0;\n                      }\n                  }\n              \n                  var input = [];\n                  //creating a 2d array of total votes received \n                  for (var i = 0; i < resultdata.rows.length; i++) {\n                      if (id == resultdata.rows[i].proposal_id) {\n                          input.push(resultdata.rows[i].choices)\n                      }\n                  }\n              \n                  // calculaing votes based on ranks\n                  //j is the candidate and val-1 is the total votes received for the rank\n                  for (var i = 0; i < input.length; i++) {\n                      for (j = 0; j < input[i].length; j++) {\n                          var val = input[i][j];\n                          result[j][val - 1] += 1;\n                      }\n                  }\n                  });\n              \n                   eosinstance.getTableRows({\n                      code: \"voteproposal\",\n                      scope: \"voteproposal\",\n                      table: \"proposal11\",\n                      limit: \"50\",\n                      json: true,\n                  }).then((response)=>{\n                    candidatedata=response;\n                });\n              \n                  console.log(\"resultdata \", resultdata);\n              \n                \n              \n                  var candidatelist = []\n                  for(var i=0;i<candidatedata.rows.length;i++){\n                      if(id == candidatedata.rows[i].id){\n                          for(var j=0;j<candidatedata.rows[i].proposal_options.length;j++){\n                              var val = candidatedata.rows[i].proposal_options[j]\n                              document.getElementById(\"proposal-result-name\").innerHTML += \"<br><div class = 'ep'>\"+val+\"</div>\"\n                  \n                          }\n                                      \n                      }\n                  }\n                  console.log(\"candidatedata\", candidatedata);\n                  console.log(\"result after calculating \", result);\n                  \n                  /* for(var i=0;i<result.length;i++){\n                      document.getElementById(\"proposal-result-votes\").innerHTML +=\"<br><div class = 'ep'>\"+ result[i].toString().replace(/,/g, '/')+\"</div>\";\n                      \n                  } */\n              \n              \n                  for(var i=0;i<result.length;i++){\n                      document.getElementById(\"proposal-result-votes\").innerHTML +=\"<br><div class = 'ep2'></div>\";\n              \n                      for(var j=0;j<result[i].length;j++){\n                          var val = result[i][j]\n                          document.getElementsByClassName(\"ep2\")[i].innerHTML += \"<div class = 'vote-stat'>\"+val+\"</div>\"\n                      }\n                      \n                  }\n              } else {\n                  FlowRouter.go(\"/\");\n              }\n          }\n      } else {\n          console.log(\"scatter not installed\")\n      }\n  });\n});\n\nTemplate.App_result.helpers({\n    /* calcvote: async function () {\n        var result = [];\n        var length = 0;\n        var id = FlowRouter.current().params.id;\n        console.log(\"id: \", id);\n        let resultdata = eos.getTableRows({\n            code: \"voteproposal\",\n            scope: \"voteproposal\",\n            table: \"votes13\",\n            limit: \"50\",\n            json: true,\n            key_type: \"i64\",\n            index_position: 2\n        });\n\n        let candidatedata = eos.getTableRows({\n            code: \"voteproposal\",\n            scope: \"voteproposal\",\n            table: \"proposal11\",\n            limit: \"50\",\n            json: true,\n        });\n        console.log(\"resultdata \", resultdata);\n        console.log(\"candidate data: \", candidatedata);\n\n        //getting the length of list of all choices for a  particular proposal\n        var length = 0;\n        for (var i = 0; i < resultdata.rows.length; i++) {\n            if (id == resultdata.rows[i].proposal_id) {\n                length = resultdata.rows[i].choices.length;\n                break;\n            }\n        }\n\n        //creating a 2d array and setting initial votes to 0\n        for (var i = 0; i < length; i++) {\n            result[i] = [];\n        }\n\n        for (var i = 0; i < length; i++) {\n            for (var j = 0; j < length; j++) {\n                result[i][j] = 0;\n            }\n        }\n\n        var input = [];\n        //creating a 2d array of total votes received \n        for (var i = 0; i < resultdata.rows.length; i++) {\n            if (id == resultdata.rows[i].proposal_id) {\n                input.push(resultdata.rows[i].choices)\n            }\n        }\n        for(var i=0;i<input.length;i++){\n            for(j=0;j<input[i].length;j++){\n                var val = input[i][j];\n                result[j][val-1] += 1;\n            }\n        }\n    \n        console.log(\"result after calculating \", result);\n        return result[0];\n\n    }, */\n})\n\nTemplate.App_result.onRendered(async function () {\n   \n});"]},"sourceType":"script","hash":"ba26f76f9b07012fab2f32049970db4057be15c8"}
